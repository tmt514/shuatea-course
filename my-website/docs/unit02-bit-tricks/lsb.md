---
sidebar_position: 11
sidebar_label: "🟨 找出 LSB 最低有效位元"
---

# 找出 LSB 最低有效位元

找出最低有效位元（Least Significant Bit, LSB）是使用位元計算的最基礎技巧。有了這個技巧以後，我們可以拿它來應用在更多的位元計算技巧上。

:::note 找出最低有效位元 Least Significant Bit
給定一個正整數 $x$，找出 $x$ 寫成二進制以後，最末尾的 1 的位置。換句話說，我們想要找到的是 2 的最大次方 $2^k$，使得 $2^k$ 可以整除 $x$ 但是 $2^{k+1}$ 不會整除 $x$。

比方說輸入 $x=120$ 的時候，輸出為 $8$。又或者輸入為 $x=514$ 的時候，輸出為 $2$。
:::

## 方法 1：利用減法

以 $x=108$ 為例子，如果我們觀察 $x-1=107$，並且將 $x$ 和 $x-1$ 的二進位都寫出來：

$$
\begin{aligned}
108 &= ({\tt{{\color{blue}{110}}10000}})_2\\
107 &= ({\tt{{\color{blue}{110}}01111}})_2
\end{aligned}
$$

會發現，前面 3 個 bit 都是相同的，唯一的差別只有從 LSB 往下的那些位元不同而已！因此，如果我們將兩個數字用 Bitwise AND 結合起來，就會留下共同的部分。再從原本的數值中減去這個共同的部分，就能達到目的啦！

```cpp
int find_lsb(int x) {
  return x - (x & (x - 1));
}
```

## 方法 2：利用二的補數 2's complement

除了減去 1 這樣的操作以外，我們可以利用二的補數來幫助我們達到目標。
考慮 $108$ 與 $-108$ 在 32-位元有號整數的表示法：

$$
\begin{aligned}
108 &= ({\tt{{\color{red}{00000000\ 00000000\ 00000000\ 110}}10000}})\\
-108 &= ({\tt{{\color{red}{11111111\ 11111111\ 11111111\ 001}}10000}})
\end{aligned}
$$

不難發現這兩個數字共同的部分恰好就是 LSB 開始往下的那些位元！因此我們得到一個更簡短的方式找出 LSB：

```cpp
int find_lsb(int x) {
  return x & -x;
}
```