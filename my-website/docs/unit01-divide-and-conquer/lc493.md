---
sidebar_position: 102
sidebar_label: "ğŸŸ§ Leetcode 493. Reverse Pairs"
---

# Leetcode 493. Reverse Pairs

[ğŸ”— é¡Œç›®é€£çµ](https://leetcode.com/problems/reverse-pairs/)

:::note é¡Œç›®æ•˜è¿°
çµ¦å®šä¸€å€‹é™£åˆ— `nums`ï¼Œæ‰¾å‡º **reverse pairs** çš„æ•¸é‡ã€‚ä¸€å€‹ reverse pair çš„å®šç¾©ï¼Œç‚ºä¸€å€‹è¨»æ¨™é…å° $(i, j)$ï¼Œå…¶ä¸­ $i < j$ ä¸¦ä¸” ${\tt{nums}}[i] > 2\times {\tt{nums}}[j]$ã€‚

æ¯”æ–¹èªªè¼¸å…¥ç‚º $[1, 3, 2, 3, 1]$ çš„æ™‚å€™ï¼Œè¼¸å‡ºç‚º $2$ã€‚
:::

## è§£é¡Œæ€è€ƒ

é€™é¡Œè·Ÿé€†åºæ•¸å°éå¸¸ç›¸ä¼¼ï¼å”¯ä¸€èˆ‡é€†åºæ•¸å°ä¸åŒçš„åœ°æ–¹ï¼Œæ˜¯è¦æ±‚åœ¨è¨ˆæ•¸çš„æ™‚å€™ï¼Œå·¦é‚Šçš„æ•¸å€¼è¶…éå³é‚Šçš„å…©å€ã€‚

## å¯¦ä½œç´°ç¯€

1. æˆ‘å€‘å¯ä»¥æŠŠã€Œè¨ˆæ•¸ã€çš„éƒ¨åˆ†èˆ‡ã€Œåˆä½µæ’åºã€çš„éƒ¨åˆ†åˆ†é–‹å¯¦ä½œï¼Œé€™æ¨£æ¯”è¼ƒä¹¾æ·¨ã€‚
2. åˆ©ç”¨ STL è£¡é¢çš„åˆä½µæ’åºå‡½å¼ï¼Œå¯ä»¥è¼•é¬†é¿å…æ‰éº»ç…©çš„éƒ¨åˆ†ã€‚

## åƒè€ƒç¨‹å¼ç¢¼(C++)

```cpp
class Solution {
 public:
  int count;

  void combine(vector<int>& nums, int l, int m, int r) {
    // è¨ˆæ•¸çš„éƒ¨åˆ†ã€‚
    for (int i = l, j = m; i < m; i++) {
      while (j <= r && nums[i] > 2LL * nums[j]) ++j;
      count += j - m;
    }
    // åˆä½µæ’åºçš„éƒ¨åˆ†ã€‚
    vector<int> tmp(r - l + 1);
    std::merge(nums.begin() + l, nums.begin() + m, nums.begin() + m,
               nums.begin() + r + 1, tmp.begin());
    std::copy(tmp.begin(), tmp.end(), nums.begin() + l);
  }

  void mergesort(vector<int>& nums, int l, int r) {
    if (l >= r) return;
    int m = (l + r) / 2;
    mergesort(nums, l, m);
    mergesort(nums, m + 1, r);
    combine(nums, l, m + 1, r);
  }

  int reversePairs(vector<int>& nums) {
    count = 0;
    mergesort(nums, 0, nums.size() - 1);
    return count;
  }
};
```

## è¤‡é›œåº¦åˆ†æ

`combine()` çš„åŸ·è¡Œæ™‚é–“æ˜¯ç·šæ€§çš„ $O(r-l+1)$ï¼Œå› æ­¤æ•´é«”æ™‚é–“è¤‡é›œåº¦èˆ‡åˆä½µæ’åºæ³•ç›¸åŒï¼Œçš†ç‚º $O(n\log n)$ã€‚

## å‚™è¨»/è¡ä¼¸æ€è€ƒ

é€™å€‹é¡Œç›®ç•¶ç„¶ä¹Ÿæœ‰å…¶ä»–è§£æ³•ï¼Œå¯«èµ·ä¾†ä¹Ÿç›¸ç•¶å®¹æ˜“ã€‚æ¯”æ–¹èªªï¼Œç›´æ¥ä½¿ç”¨å¹³è¡¡äºŒå…ƒæ¨¹é€²è¡Œå‹•æ…‹çš„æ’å…¥æˆ–æŸ¥æ‰¾ï¼›åˆæˆ–è€…æ˜¯åœ¨é›¢æ•£åŒ–ï¼ˆå–å¾—æ¯ä¸€å€‹æ•¸å€¼ç›¸å°æ‡‰çš„ç§©ï¼‰ä¹‹å¾Œä½¿ç”¨ Binary Index Treeã€‚ä¸éç”±æ–¼æœ¬ç« ç¯€æˆ‘å€‘æƒ³è¦æ³¨é‡çš„æ˜¯åˆ†è€Œæ²»ä¹‹æ³•çš„æ¦‚å¿µï¼Œå› æ­¤æˆ‘å€‘å°±æš«æ™‚ä¸æå…¶ä»–å¹¾ç¨®è§£æ³•å›‰ã€‚
